defaults:
  - graph: dynamic_jacobi_circle
  - reward: ieft
  - system: numa
  - feature: cnn_batch
  # - network: cnn_batch_lstm
  - network: cnn_batch
  - algorithm: ppo
  - runtime: batch
  - wandb: default
  - logging: default
  - lr_scheduler: none 
  - optimizer: adamw
  - eval: default
  - _self_

hydra:
  callbacks:
    git_info:
      _target_: train.GitInfo
seed: 532
deterministic_torch: true

reward:
  verbose: true
  random_start: false

graph:
  config:
      n: 8
      steps: 60
      interior_compute_ratio: 2
      boundary_compute_ratio: 1
      workload_args:
        lower_bound: 1000
        upper_bound: 5000
        scale: 0.05
        traj_specifics: 
          radius: 0.25
  env:
    change_priority: True
    change_locations: True
    seed: 1

algorithm:
  rollout_steps: 60
  workers: 4
  ent_coef: 0.001
  sample_slices: True
  slice_len: 8

optimizer:
  lr: 2.5e-4

system:
  mem: 13130000

feature:
  observer:
    prev_frames: 0
    batched: true

network:
  layers:
    # lstm:
    #   hidden_size: 64 # Adjust the LSTM hidden size by hidden_channels ** (log2(n)-1)
    state:
      hidden_channels: 16
    actor:
      hidden_channels: 16
    critic:
      hidden_channels: 128

runtime:
  batch_size: 5
  queue_threshold: 5
  max_in_flight: 64

wandb:
  enabled: true
  dir: /Users/jaeyoung/work/nanobind_task4feedback
  project: 8x8x60_circle
  name: default
eval:
  eval_interval: 0

